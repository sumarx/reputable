<% content_for :page_title, "Campaign Response from #{@response.customer_name || 'Anonymous'}" %>

<div class="space-y-6">
  <%= link_to "â† Back to #{@campaign.name}", campaign_path(@campaign), class: "text-sm text-indigo-600 hover:text-indigo-500" %>

  <!-- Response Detail -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <div class="flex items-start justify-between mb-4">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
          <span class="text-sm font-medium text-indigo-600"><%= (@response.customer_name || "A").first.upcase %></span>
        </div>
        <div>
          <h2 class="text-lg font-semibold text-gray-900"><%= @response.customer_name || "Anonymous" %></h2>
          <p class="text-sm text-gray-500">
            <%= @campaign.name %> Â· <%= @campaign.location.name %>
          </p>
        </div>
      </div>
      <div class="text-right">
        <div class="text-lg text-yellow-500"><%= 'â˜…' * (@response.rating || 0) %><%= 'â˜†' * (5 - (@response.rating || 0)) %></div>
        <p class="text-xs text-gray-400"><%= @response.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
      </div>
    </div>

    <!-- Status Badges -->
    <div class="flex gap-2 mb-4">
      <% case @response.outcome %>
      <% when 'redirect' %>
        <% if @response.clicked_external? %>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
            ðŸš€ Clicked to Post on <%= @campaign.redirect_platform.capitalize %>
          </span>
        <% else %>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
            âœ“ Shown <%= @campaign.redirect_platform.capitalize %> Redirect
          </span>
        <% end %>
      <% when 'private' %>
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
          Private Feedback
        </span>
      <% end %>
      <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
        via <%= @campaign.campaign_type.upcase %> Campaign
      </span>
    </div>

    <% if @response.feedback.present? %>
      <div class="prose prose-sm max-w-none text-gray-700 mb-4">
        <p><%= @response.feedback %></p>
      </div>
    <% else %>
      <p class="text-sm text-gray-400 italic mb-4">No written feedback provided.</p>
    <% end %>

    <% if @response.customer_phone.present? %>
      <div class="border-t border-gray-200 pt-4">
        <p class="text-sm text-gray-500">ðŸ“ž Phone: <span class="text-gray-900"><%= @response.customer_phone %></span></p>
      </div>
    <% end %>
  </div>
</div>
